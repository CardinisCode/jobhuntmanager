{% extends "layout.html" %}

{% block title %}
    Dashboard
{% endblock %}

{% block main %}
    <h1 class="text-center"> Dashboard </h1>
    <hr/>

    {% if get_flashed_messages() %}
        {% for message in get_flashed_messages() %}
            <div class="flash alert alert-success border text-center">{{ message }}</div>
        {% endfor %}
    {% endif %}

    <div> 
        <table>
            <tr class="border-right border-left">
                <th class="text-center border-bottom border-right border-left border-top"> Applications Submitted Today</th>
                <th class="text-center border-left border-right"> </th>
                <th class="text-center border-bottom border-right border-left border-top"> Interviews Today</th>
                <th class="text-center border-left border-right"> </th>
                <th class="text-center border-bottom border-right border-left border-top"> Job Offers</th>
            </tr>
            <tr class="border-right border-left"> 
                <td class="text-center border-bottom border-right border-left border-top"> {{ display.applications_today }}</td>
                <td class="text-center border-left border-right"> </td>
                <td class="text-center border-bottom border-right border-left border-top"> {{ display.interviews_today }}</td>
                <td class="text-center border-left border-right"> </td>
                <td class="text-center border-bottom border-right border-left border-top"> {{ display.job_offer_count }}</td>
            </tr>
        </table>

    </div>
    <br/>
    
    <!-- Drop down to view table-->
    <div class="horizontal_buttons text-center">
        <a href={{ display.add_application_url }} class="button middle_button"><i class="fas fa-plus"> Add Job Application </i></a>
        <a href="/applications" class="button middle_button"><i class="fas fa-eye"> View all Applications</i> </a>
        {% if job_offer_details == None %}
            <a href="/add_job_offer" class="link_right"><i class="fas fa-plus"> Add Job Offer</i> </a>
        {% endif %}
    </div>

    <hr/>

    {% if job_offer_details != None %}
        <h2 class="text-center"> Job Offers: </h2>
        <br/>

        {% for job_offer_id, fields in display.job_offer_details.items() %}
            <h3 class="text-center"> {{ fields.company_name }}</h3>
            <div class="text-center"> 
                <i class="fas fa-calendar-alt"></i> <strong> Starting Date:</strong> {{ fields.starting_date }}
            </div>
            {% if fields.job_role %}
                <div class="text-center"> 
                    <strong> Job Role:</strong> {{ fields.job_role }}
                </div>
            {% endif %}
            {% if fields.offer_response %}
                <div class="text-center"> 
                    <strong> Offer Response:</strong> {{ fields.offer_response }}
                </div>
            {% endif %}
            {% if fields.salary_offered %}
                <div class="text-center"> 
                    <strong> Salary On Offer:</strong> {{ fields.salary_offered }}
                </div>                    
            {% endif %}
            {% if fields.perks_offered %}
                <div class="text-center"> 
                    <strong> Perks Offered: </strong> {{ fields.perks_offered }}
                </div>           
            {% endif %}
            {% if fields.update_url %}
            <div class="text-center"> 
                <a href={{ fields.update_url }}><i class="fas fa-pencil-alt"> Update</i> </a>
            </div>           
            {% endif %}
            <br/>
        {% endfor %}
        <br/>
        <div class="text-center"> 
            <a href="/add_job_offer" class="link_right"><i class="fas fa-plus"> Add Job Offer</i> </a>
        </div>

        <hr/>
    {% endif %}

    <h2 class="text-center"> Upcoming Interviews: </h2>
    <br/>

    {% if display.all_interviews != None and display.interview_details != None %}
        {% for company_name, interviews in display.interview_details.items() %}
            {% for interview_id, fields in interviews.items() %}
                <h4 class="text-center"> {{ company_name }} </h4>
                <div class="text-center"> 
                    <i class="fas fa-calendar-alt"></i> {{ fields.Date }} @ {{ fields.Time }}
                </div> 

                <div class="text-center"> 
                    {% if fields.interview_type == 'in_person' %}
                        <i class="fas fa-location-arrow"></i> {{ fields.Location }}
                    {% elif fields.interview_type == 'video_or_online' %}
                        <i class="fas fa-video"></i> {{ fields.interview_medium }}
                    {% else %}
                        <i class="fas fa-mobile-alt"></i> {{ fields.contact_number }}
                    {% endif %}
                </div> 
                {% if fields.interviewers %}
                    <div class="text-center"> 
                        <i class="fas fa-users"> Interviewers: </i> {{ fields.interviewers }}
                    </div>
                {% endif %}
                {% if fields.past_dated %}
                    <div class="text-center"> 
                        This is a <strong> past-dated</strong> interview! You may want to <a href={{ fields.update_url }}>update</a> the status. 
                    </div>
                {% endif %}
                <div class="text-center"> 
                    {% if fields.past_dated == False %}
                        <a href={{ fields.prepare_url }}> <i class="fas fa-clipboard"> Prepare</i></a>
                    {% endif %}
                    <a href={{ fields.View_More }}><i class="fas fa-eye"> View More</i></a>
                    <a href={{ fields.update_url }}><i class="fas fa-pencil-alt"> Update Details</i></a>
                </div>
                
                <br/>
            {% endfor %}
        {% endfor %}
    {% endif %}
    <hr/>


{% endblock %}